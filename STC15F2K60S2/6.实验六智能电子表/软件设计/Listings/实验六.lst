C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE ______
OBJECT MODULE PLACED IN .\Objects\实验六.obj
COMPILER INVOKED BY: E:\keil_v5\C51\BIN\C51.EXE 实验六.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\实
                    -验六.lst) OBJECT(.\Objects\实验六.obj)

line level    source

   1          ////////////////////////////////////////////////////////////////////////////////////////
   2          //设计项目:设计一个基于单片机的智能电子表                                             //
   3          //设 计 人:畅福善                                                                     //
   4          //设计时间:2016.5.30                                                                  //
   5          //设计说明:设计一个智能电子表， 利用中断实现智能电子钟的自动走时设计，并在8个数码管上 //
   6          //                 分别显示走时过程(XX-XX-XX)，即XX时、XX分、XX秒中间采用"-"分开；            //
   7          //         利用四个独立按键完成时、分、秒的初始化设置                       //
   8          //         硬件连接条件:1、单片机P0.0~P0.7依次连接第1~8个LED指示灯                    //
   9          //                      2、4个模拟开关依次连接到P3.4,P3.5,P3.6,P3.7                   //
  10          //                      3、数码管数据连接IC7 锁存控制P2.6                             //
  11          //                      4、数码管数据连接IC6 锁存控制P2.7                             //
  12          ////////////////////////////////////////////////////////////////////////////////////////
  13          
  14          //#include <AT89X51.H> 
  15          //#include "STC89C52RC.H" 
  16          #include "STC15F2K60S2.H" 
  17          ////////函数说明////////
  18          void delay02s(void);            //延时2秒子程序//
  19          void delay10ms(void);           //延时10ms的子程序//
  20          void delay500us(void);          //延时500us的子程序//
  21          void delay50us(void);           //延时50us的子程序//
  22          void baojing(void); 
  23          void int_time0(void);       //t0定时器初始化函数 
  24          void int_time1(void);       //t1定时器初始化函数  
  25          void key_set(void);      //设置按键函数
  26          void display_seg_set_hours_min_s(void);//数码管小时设置显示函数
  27          void display_seg_HC6800(void);      //显示函数
  28          ////////初始化函数////////
  29          void alarm_buzzer(void );/////交流蜂鸣器自检
  30          void SEG_init(void);      //数码管初始化函数
  31          void LED_init(void);      //LED初始化函数
  32          void key_init(void);      //按键初始化函数
  33          void fmq_ceshi(void);     //蜂鸣器自检
  34          ////////变量说明////////
  35          //led定义
  36          sbit L1=P1^0;//////定义第1个指示灯的名称为L1  还可以直接采用P0_0;因为AT89X51.H内部已做定义,下依次类推
  37          sbit L2=P1^1;//////定义第2个指示灯的名称为L2 
  38          sbit L3=P1^2;//////定义第3个指示灯的名称为L3  
  39          sbit L4=P1^3;//////定义第4个指示灯的名称为L4 
  40          sbit L5=P1^4;//////定义第5个指示灯的名称为L5  
  41          sbit L6=P1^5;//////定义第6个指示灯的名称为L6 
  42          sbit L7=P1^6;//////定义第7个指示灯的名称为L7  
  43          sbit L8=P1^7;//////定义第8个指示灯的名称为L8 
  44          //按键定义
  45          sbit key_1=P3^4;//////定义第1个按键为KEY_1
  46          sbit key_2=P3^5;//////定义第1个按键为KEY_2
  47          sbit key_3=P4^2;//////定义第1个按键为KEY_3
  48          sbit key_4=P4^4;//////定义第1个按键为KEY_4
  49          //锁存器定义
  50          sbit duan_clc=P2^6;//////定义段锁存器(IC7)时钟脉冲
  51          sbit wen_clc=P2^7;//////定义位锁存器(IC6)时钟脉冲
  52          //蜂鸣器定义
  53          sbit FMQ=P3^2;//////定义fmq蜂鸣器单片机驱动口
  54          
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 2   

  55          /////////////////////////////
  56          unsigned  char count;/////////按键计数器
  57          
  58          unsigned  char code table[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x
             -71,0x40,0x00};////数码管显示码表
  59          //////////////////////////////0     1    2    3    4    5    6    7    8    9   A    B     C    D    E    F     
             -                                   
  60          unsigned  char shiwei;//10位数据
  61          unsigned  char gewei;//个位数据                                 
  62          unsigned  char SEG_1,SEG_2,SEG_3,SEG_4,SEG_5,SEG_6,SEG_7,SEG_8;//////8个数码管对应显示单元定义
  63          bit flag_baojing;///////定义报警标志
  64          
  65          unsigned char jsq_50ms,jsq_1s;///////50ms计数器和1S计数器
  66          unsigned char jsq_1min,jsq_1hours;///////1分计数器和1小时计数器
  67          ///////////////一键多功能计数器的设置//////////////
  68          unsigned char jsq_function;///////功能计数器
  69          unsigned char jsq_set_xianshi;///////设置显示计数器
  70          //////////////闹铃时间设置//////////////
  71          unsigned char jsq_naoling_1hours=1,jsq_naoling_1min,jsq_naoling_1s=1;///////闹铃时间
  72          
  73          
  74          void main(void)                         //主程序//
  75                  {   
  76   1              /////////初始化区////////////////
  77   1              key_init();////////按键初始化
  78   1          fmq_ceshi();//交流蜂鸣器初始化、自检 
  79   1              LED_init();////////指示灯初始化、自检
  80   1              SEG_init();////////数码管初始化、自检
  81   1              int_time0();/////初始化t0定时器
  82   1              int_time1();/////初始化t1定时器
  83   1              while(1)                            //进入循环//以下为无限循环程序区
  84   1              {
  85   2      //TR0=0;TR1=0; 
  86   2      ////////////////利用中断实验时间与数码管的关系,其中采用中断函数计数//////////////////////////////////////
  87   2                      key_set();///按键设置函数
  88   2                      //display_seg_HC6800();      //显示函数
  89   2                      display_seg_set_hours_min_s();  //调用电子表设置显示函数
  90   2                      //if(jsq_naoling_1hours==jsq_1hours&&jsq_naoling_1min==jsq_1min&&jsq_naoling_1s==jsq_1s){
  91   2                      //TR1=1;}
  92   2                      //if(jsq_naoling_1hours==jsq_1hours&&jsq_naoling_1min==jsq_1min&&jsq_naoling_1s+5==jsq_1s){
  93   2                      //TR1=0;}
  94   2              } 
  95   1      }
  96                  
  97          void baojing(void)
  98          {
  99   1      unsigned  int baojing_i;
 100   1                        for(baojing_i=100;baojing_i>0;baojing_i--)
 101   1                         {
 102   2                          P14=~P14;               //P1_0取反//
 103   2                              delay500us();            //延时500us//
 104   2                         }
 105   1      }
 106          
 107          
 108          void fmq_ceshi()
 109          {       
 110   1      //////////蜂鸣器初始化////////////////////
 111   1              FMQ=0;
 112   1              delay02s();delay02s();delay02s();delay02s();delay02s();///声音延长时间
 113   1              FMQ=1;
 114   1      }
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 3   

 115          ///////////////////////////////////////////////////
 116          //函数名称:void key_set(void)
 117          //函数功能:设置按键函数
 118          //入口参数:
 119          //出口参数:
 120          //函数说明:
 121          ///////////////////////////////////////////////////
 122          void key_set(void)      //设置按键函数
 123          {
 124   1      
 125   1      ///////////1键多功能/////////////////////////
 126   1              if(key_1==0)/////////如果按键按下
 127   1              {
 128   2                delay10ms();///////延时10ms
 129   2                if(key_1==0)///////按键的确按下
 130   2                  {
 131   3                      TR0=0;
 132   3                      jsq_function++;///////按键计数器计数
 133   3                      if(jsq_function>=7){jsq_function=0;}//////控制计数器最大值;16即为16进制;20即为20进制;但最大计数255，因为
             -count定义的是unsigend char
 134   3                      //while(key_1==0){display_seg_set_hours_min_s();}///////按键等待抬起
 135   3                      while(key_1==0){display_seg_set_hours_min_s();}///////按键等待抬起
 136   3                      }
 137   2              }
 138   1      
 139   1      ///////////功能1/////////////////////////
 140   1              if(jsq_function==1)
 141   1              {
 142   2                      if(key_2==0)/////////如果按键按下
 143   2                      {
 144   3                        delay10ms();///////延时10ms
 145   3                        if(key_2==0)///////按键的确按下
 146   3                          {
 147   4                              TR0=0;
 148   4                              jsq_1hours++;
 149   4                              if(jsq_1hours==24){jsq_1hours=23;}//////控制小时计数器最大值
 150   4                              while(key_2==0){display_seg_set_hours_min_s();}///////按键等待抬起
 151   4                              }
 152   3                      }
 153   2                      if(key_3==0)/////////如果按键按下
 154   2                      {
 155   3                        delay10ms();///////延时10ms
 156   3                        if(key_3==0)///////按键的确按下
 157   3                          {
 158   4                              TR0=0;
 159   4                              jsq_1hours--;
 160   4                              if(jsq_1hours==255){jsq_1hours=0;}//////控制小时计数器最大值
 161   4                              while(key_3==0){display_seg_set_hours_min_s();}///////按键等待抬起
 162   4                              }
 163   3                      }
 164   2              }
 165   1      ///////////功能2/////////////////////////
 166   1              if(jsq_function==2)
 167   1              {
 168   2                      if(key_2==0)/////////如果按键按下
 169   2                      {
 170   3                        delay10ms();///////延时10ms
 171   3                        if(key_2==0)///////按键的确按下
 172   3                          {
 173   4                              TR0=0;
 174   4                              jsq_1min++;
 175   4                              if(jsq_1min==60){jsq_1min=59;}//////控制小时计数器最大值
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 4   

 176   4                              while(key_2==0){display_seg_set_hours_min_s();}///////按键等待抬起
 177   4                              }
 178   3                      }
 179   2                      if(key_3==0)/////////如果按键按下
 180   2                      {
 181   3                        delay10ms();///////延时10ms
 182   3                        if(key_3==0)///////按键的确按下
 183   3                          {
 184   4                              TR0=0;
 185   4                              jsq_1min--;
 186   4                              if(jsq_1min==255){jsq_1min=0;}//////控制小时计数器最大值
 187   4                              while(key_3==0){display_seg_set_hours_min_s();}///////按键等待抬起
 188   4                              }
 189   3                      }
 190   2              }
 191   1      ///////////功能3/////////////////////////
 192   1              if(jsq_function==3)
 193   1              {
 194   2                      if(key_2==0)/////////如果按键按下
 195   2                      {
 196   3                        delay10ms();///////延时10ms
 197   3                        if(key_2==0)///////按键的确按下
 198   3                          {
 199   4                              TR0=0;
 200   4                              jsq_1s++;
 201   4                              if(jsq_1s==60){jsq_1s=59;}//////控制小时计数器最大值
 202   4                              while(key_2==0){display_seg_set_hours_min_s();}///////按键等待抬起
 203   4                              }
 204   3                      }
 205   2                      if(key_3==0)/////////如果按键按下
 206   2                      {
 207   3                        delay10ms();///////延时10ms
 208   3                        if(key_3==0)///////按键的确按下
 209   3                          {
 210   4                              TR0=0;
 211   4                              jsq_1s--;
 212   4                              if(jsq_1s==255){jsq_1s=0;}//////控制小时计数器最大值
 213   4                              while(key_3==0){display_seg_set_hours_min_s();}///////按键等待抬起
 214   4                              }
 215   3                      }
 216   2          }
 217   1      ///////////功能4//闹铃设置///////////////////////
 218   1              if(jsq_function==4)
 219   1              {
 220   2                      if(key_2==0)/////////如果按键按下
 221   2                      {
 222   3                        delay10ms();///////延时10ms
 223   3                        if(key_2==0)///////按键的确按下
 224   3                          {
 225   4                              TR0=0;
 226   4                              jsq_naoling_1hours++;
 227   4                              if(jsq_naoling_1hours==24){jsq_naoling_1hours=23;}//////控制小时计数器最大值
 228   4                              while(key_2==0){display_seg_set_hours_min_s();}///////按键等待抬起
 229   4                              }
 230   3                      }
 231   2                      if(key_3==0)/////////如果按键按下
 232   2                      {
 233   3                        delay10ms();///////延时10ms
 234   3                        if(key_3==0)///////按键的确按下
 235   3                          {
 236   4                              TR0=0;
 237   4                              jsq_naoling_1hours--;
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 5   

 238   4                              if(jsq_naoling_1hours==255){jsq_naoling_1hours=0;}//////控制小时计数器最大值
 239   4                              while(key_3==0){display_seg_set_hours_min_s();}///////按键等待抬起
 240   4                              }
 241   3                      }
 242   2              }
 243   1      ///////////功能5/////////////////////////
 244   1              if(jsq_function==5)
 245   1              {
 246   2                      if(key_2==0)/////////如果按键按下
 247   2                      {
 248   3                        delay10ms();///////延时10ms
 249   3                        if(key_2==0)///////按键的确按下
 250   3                          {
 251   4                              TR0=0;
 252   4                              jsq_naoling_1min++;
 253   4                              if(jsq_naoling_1min==60){jsq_naoling_1min=59;}//////控制小时计数器最大值
 254   4                              while(key_2==0){display_seg_set_hours_min_s();}///////按键等待抬起
 255   4                              }
 256   3                      }
 257   2                      if(key_3==0)/////////如果按键按下
 258   2                      {
 259   3                        delay10ms();///////延时10ms
 260   3                        if(key_3==0)///////按键的确按下
 261   3                          {
 262   4                              TR0=0;
 263   4                              jsq_naoling_1min--;
 264   4                              if(jsq_naoling_1min==255){jsq_naoling_1min=0;}//////控制小时计数器最大值
 265   4                              while(key_3==0){display_seg_set_hours_min_s();}///////按键等待抬起
 266   4                              }
 267   3                      }
 268   2              }
 269   1      ///////////功能3/////////////////////////
 270   1              if(jsq_function==6)
 271   1              {
 272   2                      if(key_2==0)/////////如果按键按下
 273   2                      {
 274   3                        delay10ms();///////延时10ms
 275   3                        if(key_2==0)///////按键的确按下
 276   3                          {
 277   4                              TR0=0;
 278   4                              jsq_naoling_1s++;
 279   4                              if(jsq_naoling_1s==60){jsq_naoling_1s=59;}//////控制小时计数器最大值
 280   4                              while(key_2==0){display_seg_set_hours_min_s();}///////按键等待抬起
 281   4                              }
 282   3                      }
 283   2                      if(key_3==0)/////////如果按键按下
 284   2                      {
 285   3                        delay10ms();///////延时10ms
 286   3                        if(key_3==0)///////按键的确按下
 287   3                          {
 288   4                              TR0=0;
 289   4                              jsq_naoling_1s--;
 290   4                              if(jsq_naoling_1s==255){jsq_naoling_1s=0;}//////控制小时计数器最大值
 291   4                              while(key_3==0){display_seg_set_hours_min_s();}///////按键等待抬起
 292   4                              }
 293   3                      }
 294   2          }
 295   1              
 296   1              //定时报警//
 297   1              if(flag_baojing==0&&(jsq_naoling_1hours==jsq_1hours)&&(jsq_naoling_1min==jsq_1min)&&((jsq_1s>=jsq_naoling
             -_1s)&&(jsq_1s<=jsq_naoling_1s+5)))
 298   1                      {
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 6   

 299   2                      FMQ=0;P14=0;
 300   2                      }
 301   1            else{FMQ=1;P14=1;}
 302   1      
 303   1      ///////////功能结束开表运行/////////////////////////
 304   1      
 305   1              if(key_4==0)/////////如果按键按下
 306   1              {
 307   2                delay10ms();///////延时10ms
 308   2                if(key_4==0)///////按键的确按下
 309   2                  {
 310   3                      TR0=1;///////开表0
 311   3                      TR1=0;///////停表1
 312   3                      jsq_function=0;////功能计数器清0
 313   3                      while(key_4==0){display_seg_set_hours_min_s();}///////按键等待抬起
 314   3                      }
 315   2              }
 316   1      
 317   1      }
 318          
 319          
 320          
 321          ///////////////////////////////////////////////////
 322          //函数名称:void delay500us(void)
 323          //函数功能:延时500us秒的子程序
 324          //入口参数:
 325          //出口参数:
 326          //函数说明:
 327          ///////////////////////////////////////////////////
 328          void delay500us(void)           //延时10ms的子程序//
 329            {             
 330   1              unsigned char k; /////局部变量定义
 331   1              for(k=248;k>0;k--) ////内层循环
 332   1                      {
 333   2                      ;
 334   2                      }
 335   1        }  
 336          ///////////////////////////////////////////////////
 337          //函数名称:void delay10ms(void)
 338          //函数功能:延时10ms秒的子程序
 339          //入口参数:
 340          //出口参数:
 341          //函数说明:
 342          ///////////////////////////////////////////////////
 343          void delay10ms(void)            //延时10ms的子程序//
 344            {             
 345   1              unsigned char j,k; /////局部变量定义
 346   1              for(j=20;j>0;j--)   // 上层循环
 347   1                      {
 348   2                      for(k=248;k>0;k--) ////内层循环
 349   2                              {
 350   3                              ;
 351   3                              }
 352   2                      }
 353   1        } 
 354           
 355          ///////////////////////////////////////////////////
 356          //函数名称:void delay02s(void)
 357          //函数功能:延时0.2秒的子程序
 358          //入口参数:
 359          //出口参数:
 360          //函数说明:
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 7   

 361          ///////////////////////////////////////////////////
 362          void delay02s(void)             //延时子程序//
 363          {               
 364   1              unsigned char i,j,k; /////局部变量定义
 365   1              for(i=20;i>0;i--)   //最外层循环
 366   1                      {
 367   2                         for(j=20;j>0;j--)   // 上层循环
 368   2                              {
 369   3                              for(k=248;k>0;k--) ////内层循环
 370   3                               {
 371   4                               ;
 372   4                               }
 373   3                              }
 374   2                      }
 375   1      } 
 376          ///////////////////////////////////////////////////
 377          //函数名称:void int_time0(void)
 378          //函数功能:定时器t0初始化
 379          //入口参数:
 380          //出口参数:
 381          //函数说明:
 382          ///////////////////////////////////////////////////
 383          void int_time0(void) 
 384          {
 385   1              //设置定时器0工作方式//
 386   1              TMOD=0x01;                                                              //定义为定时器0方式1,SFR中TMOD位于不能被8整除的地址,所以要按字节方式赋值//
 387   1              //赋值方法1//
 388   1              TH0=(65536-50000)/256;                                  //赋初值//
 389   1              TL0=(65536-50000)%256;
 390   1              //赋值方法2//
 391   1      //      TH0=(65536-100)>>8;                                     //赋初值//
 392   1      //      TL0=(65536-100);
 393   1              //打开中断通道//
 394   1              ET0=1;                                                                  //开启定时器0溢出中断//
 395   1              EA=1;                                                                   //开启总的中断开关//
 396   1      
 397   1      ///////50ms计数器和1S计数器初始内容清零///////
 398   1      jsq_50ms=0;
 399   1      jsq_1s=0;
 400   1      ///////显示秒计数器内容准备///////
 401   1      
 402   1              SEG_7=jsq_1s/10;                                                        //显示秒数的十位//
 403   1              SEG_8=jsq_1s%10;                                                        //显示秒数的个位//
 404   1      
 405   1      ///////开表/////
 406   1              TR0=1;                                                                  //开启定时器0//
 407   1      }
 408          
 409          ///////////////////////////////////////////////////
 410          //函数名称:void interrupt_t0(void)      interrupt       1
 411          //函数功能:t0中断函数
 412          //入口参数:
 413          //出口参数:
 414          //函数说明:
 415          ///////////////////////////////////////////////////
 416          void    interrupt_t0(void)      interrupt       1               //定时器0溢出中断//
 417          {
 418   1      ////////////赋初值//////////////////////////////////
 419   1              //赋初值方法1//
 420   1              TH0=(65536-50000)/256;                                  //赋初值//
 421   1              TL0=(65536-50000)%256;
 422   1              //赋初值方法2//
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 8   

 423   1      //      TH0=(65536-100)>>8;                                     //赋初值//
 424   1      //      TL0=(65536-100);
 425   1              jsq_50ms++;                                                                                     //每到一个中断为50毫秒,jsq_50ms加1//
 426   1      ///////50ms满20次=1秒//////
 427   1              if(jsq_50ms==20)                                                                        //到来20次中断后,jsq_50ms重新计数//
 428   1                      {       
 429   2                      jsq_50ms=0;
 430   2                      jsq_1s++;                                                                               //每来20次中断即为1秒,jsq_1s加1//
 431   2      ///////1s满60次=1分//////
 432   2                      if(jsq_1s==60)                                                                  //每到60秒,则重新计时//
 433   2                              {       
 434   3                              jsq_1s=0;
 435   3                              jsq_1min++;
 436   3      ///////1分满60次=1小时//////
 437   3                              if(jsq_1min==60)                                                                        //每到60分,则重新计时//
 438   3                                      {
 439   4                                      jsq_1min=0;
 440   4                                      jsq_1hours++;
 441   4      ///////1小时满24次清零//////
 442   4                                      if(jsq_1hours==24)                                                                      //每到24小时,则重新计时//
 443   4                                              {
 444   5                                      jsq_1hours=0;
 445   5                                              }
 446   4                                      }
 447   3                              }
 448   2              ///////显示秒计数器内容准备///////
 449   2      
 450   2                      SEG_1=jsq_1hours/10;;
 451   2                      SEG_2=jsq_1hours%10;
 452   2                      SEG_3=16;
 453   2                      SEG_4=jsq_1min/10;
 454   2                      SEG_5=jsq_1min%10;
 455   2                      SEG_6=16;
 456   2                      SEG_7=jsq_1s/10;                                                                //显示秒数的十位//
 457   2                      SEG_8=jsq_1s%10;        
 458   2                      }
 459   1      }
 460          ///////////////////////////////////////////////////
 461          //函数名称:void display_seg_set_hours_min_s(void)
 462          //函数功能:数码管时、分、秒显示函数
 463          //入口参数:
 464          //出口参数:
 465          //函数说明:
 466          ///////////////////////////////////////////////////
 467          void display_seg_set_hours_min_s(void)      //小时显示函数
 468          {
 469   1      
 470   1      ////////////////////利用计数器不同时间显示不同内容，完成闪烁显示/////////////////
 471   1                      jsq_set_xianshi++;
 472   1      ////////////////////调表显示/////////////////
 473   1      if(jsq_function==1||jsq_function==2||jsq_function==3)
 474   1      {
 475   2                      SEG_1=jsq_1hours/10;                                                            //显示时的十位//
 476   2                      SEG_2=jsq_1hours%10;                                                            //显示时的个位//
 477   2                      SEG_3=16;
 478   2                      SEG_4=jsq_1min/10;                                                              //显示分的十位//
 479   2                      SEG_5=jsq_1min%10;                                                              //显示分的个位//
 480   2                      SEG_6=16;
 481   2                      SEG_7=jsq_1s/10;                                                                //显示秒数的十位//
 482   2                      SEG_8=jsq_1s%10;                                                                //显示秒数的个位//
 483   2      }
 484   1      ////////////////////闹铃显示///////////////     
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 9   

 485   1      if(jsq_function==4||jsq_function==5||jsq_function==6)
 486   1      {
 487   2                      SEG_1=jsq_naoling_1hours/10;                                                            //显示时的十位//
 488   2                      SEG_2=jsq_naoling_1hours%10;                                                            //显示时的个位//
 489   2                      SEG_3=16;
 490   2                      SEG_4=jsq_naoling_1min/10;                                                              //显示分的十位//
 491   2                      SEG_5=jsq_naoling_1min%10;                                                              //显示分的个位//
 492   2                      SEG_6=16;
 493   2                      SEG_7=jsq_naoling_1s/10;                                                                //显示秒数的十位//
 494   2                      SEG_8=jsq_naoling_1s%10;                                                                //显示秒数的个位//
 495   2      }
 496   1      ////////////专用数码管闪烁/////////
 497   1                      if(jsq_function==1&&jsq_set_xianshi<=100)
 498   1                              {
 499   2                              SEG_1=17;SEG_2=17;
 500   2                              }               
 501   1                      if(jsq_function==2&&jsq_set_xianshi<=100)
 502   1                              {
 503   2                              SEG_4=17;SEG_5=17;
 504   2                              }
 505   1                      if(jsq_function==3&&jsq_set_xianshi<=100)
 506   1                              {
 507   2                              SEG_7=17;SEG_8=17;
 508   2                              }
 509   1      ///////////////////////////////////////////////////////////
 510   1                      if(jsq_function==4&&jsq_set_xianshi<=100)
 511   1                              {
 512   2                              SEG_1=17;SEG_2=17;
 513   2                              }               
 514   1                      if(jsq_function==5&&jsq_set_xianshi<=100)
 515   1                              {
 516   2                              SEG_4=17;SEG_5=17;
 517   2                              }
 518   1                      if(jsq_function==6&&jsq_set_xianshi<=100)
 519   1                              {
 520   2                              SEG_7=17;SEG_8=17;
 521   2                              }
 522   1                      if(jsq_set_xianshi>200){jsq_set_xianshi=0;}
 523   1      //////////////显示程序/////////////////////////////
 524   1      /////////1位显示//////////////////////
 525   1      P0=table[SEG_1];//////数据从P0口送出到IC7---74HC573锁存器
 526   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 527   1      P0=~0x10;//////位码从P0口送出到IC6---74HC573锁存器
 528   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 529   1      //      delay10ms();///延时0.2s
 530   1              delay500us();///延时0.5ms
 531   1              ///去鬼影//
 532   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 533   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 534   1      
 535   1      /////////2位显示//////////////////////
 536   1      P0=table[SEG_2];//////数据从P0口送出到IC7---74HC573锁存器
 537   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 538   1      P0=~0x20;//////位码从P0口送出到IC6---74HC573锁存器
 539   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 540   1      //      delay10ms();///延时0.2s
 541   1              delay500us();///延时0.5ms
 542   1              ///去鬼影//
 543   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 544   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 545   1      /////////3位显示//////////////////////
 546   1      P0=table[SEG_3];//////数据从P0口送出到IC7---74HC573锁存器
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 10  

 547   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 548   1      P0=~0x40;//////位码从P0口送出到IC6---74HC573锁存器
 549   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 550   1      //      delay10ms();///延时0.2s
 551   1              delay500us();///延时0.5ms
 552   1              ///去鬼影//
 553   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 554   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 555   1      /////////4位显示//////////////////////
 556   1      P0=table[SEG_4];//////数据从P0口送出到IC7---74HC573锁存器
 557   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 558   1      P0=~0x80;//////位码从P0口送出到IC6---74HC573锁存器
 559   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 560   1      //      delay10ms();///延时0.2s
 561   1              delay500us();///延时0.5ms
 562   1                      ///去鬼影//
 563   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 564   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 565   1      
 566   1      /////////5位显示//////////////////////
 567   1      P0=table[SEG_5];//////数据从P0口送出到IC7---74HC573锁存器
 568   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 569   1      P0=~0x01;//////位码从P0口送出到IC6---74HC573锁存器
 570   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 571   1      //      delay10ms();///延时0.2s
 572   1              delay500us();///延时0.5ms
 573   1              ///去鬼影//
 574   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 575   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 576   1      
 577   1      /////////6位显示//////////////////////
 578   1      P0=table[SEG_6];//////数据从P0口送出到IC7---74HC573锁存器
 579   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 580   1      P0=~0x02;//////位码从P0口送出到IC6---74HC573锁存器
 581   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 582   1      //      delay10ms();///延时0.2s
 583   1              delay500us();///延时0.5ms
 584   1              ///去鬼影//
 585   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 586   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 587   1      /////////7位显示//////////////////////
 588   1      P0=table[SEG_7];//////数据从P0口送出到IC7---74HC573锁存器
 589   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 590   1      P0=~0x04;//////位码从P0口送出到IC6---74HC573锁存器
 591   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 592   1      //      delay10ms();///延时0.2s
 593   1              delay500us();///延时0.5ms
 594   1              ///去鬼影//
 595   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 596   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 597   1      /////////8位显示//////////////////////
 598   1      P0=table[SEG_8];//////数据从P0口送出到IC7---74HC573锁存器
 599   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7数据锁存
 600   1      P0=~0x08;//////位码从P0口送出到IC6---74HC573锁存器
 601   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 602   1      //      delay10ms();///延时0.2s
 603   1              delay500us();///延时0.5ms
 604   1                      ///去鬼影//
 605   1      P0=0XFF;//////数据从P0口送出到IC7---74HC573锁存器
 606   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6位码数据锁存
 607   1      }
 608          ///////////////////////////////////////////////////
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 11  

 609          //函数名称:void display_seg_HC6800(void)
 610          //函数功能:HC6800开发板的数码管显示函数
 611          //入口参数:
 612          //出口参数:
 613          //函数说明:
 614          ///////////////////////////////////////////////////
 615          void display_seg_HC6800(void)      //显示函数
 616          {
 617   1      ////显示测试////
 618   1      //count=7;
 619   1      /*
 620   1      SEG_1=1;
 621   1      SEG_2=2;
 622   1      SEG_3=3;
 623   1      SEG_4=4;
 624   1      SEG_5=5;
 625   1      SEG_6=6;
 626   1      SEG_7=7;
 627   1      SEG_8=8;
 628   1      */
 629   1      ////////////////////利用计数器不同时间显示不同内容，完成闪烁显示/////////////////
 630   1                      jsq_set_xianshi++;
 631   1      ////////////////////调表显示/////////////////
 632   1      if(jsq_function==1||jsq_function==2||jsq_function==3)
 633   1      {
 634   2                      SEG_1=jsq_1hours/10;                                                            //显示时的十位//
 635   2                      SEG_2=jsq_1hours%10;                                                            //显示时的个位//
 636   2                      SEG_3=16;
 637   2                      SEG_4=jsq_1min/10;                                                              //显示分的十位//
 638   2                      SEG_5=jsq_1min%10;                                                              //显示分的个位//
 639   2                      SEG_6=16;
 640   2                      SEG_7=jsq_1s/10;                                                                //显示秒数的十位//
 641   2                      SEG_8=jsq_1s%10;                                                                //显示秒数的个位//
 642   2      }
 643   1      ////////////////////闹铃显示///////////////     
 644   1      if(jsq_function==4||jsq_function==5||jsq_function==6)
 645   1      {
 646   2                      SEG_1=jsq_naoling_1hours/10;                                                            //显示时的十位//
 647   2                      SEG_2=jsq_naoling_1hours%10;                                                            //显示时的个位//
 648   2                      SEG_3=16;
 649   2                      SEG_4=jsq_naoling_1min/10;                                                              //显示分的十位//
 650   2                      SEG_5=jsq_naoling_1min%10;                                                              //显示分的个位//
 651   2                      SEG_6=16;
 652   2                      SEG_7=jsq_naoling_1s/10;                                                                //显示秒数的十位//
 653   2                      SEG_8=jsq_naoling_1s%10;                                                                //显示秒数的个位//
 654   2      }
 655   1                      if(jsq_function==1&&jsq_set_xianshi<=100)
 656   1                              {
 657   2                              SEG_1=17;SEG_2=17;
 658   2                              }               
 659   1                      if(jsq_function==2&&jsq_set_xianshi<=100)
 660   1                              {
 661   2                              SEG_4=17;SEG_5=17;
 662   2                              }
 663   1                      if(jsq_function==3&&jsq_set_xianshi<=100)
 664   1                              {
 665   2                              SEG_7=17;SEG_8=17;
 666   2                              }
 667   1      ///////////////////////////////////////////////////////////
 668   1                      if(jsq_function==4&&jsq_set_xianshi<=100)
 669   1                              {
 670   2                              SEG_1=17;SEG_2=17;
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 12  

 671   2                              }               
 672   1                      if(jsq_function==5&&jsq_set_xianshi<=100)
 673   1                              {
 674   2                              SEG_4=17;SEG_5=17;
 675   2                              }
 676   1                      if(jsq_function==6&&jsq_set_xianshi<=100)
 677   1                              {
 678   2                              SEG_7=17;SEG_8=17;
 679   2                              }
 680   1                      if(jsq_set_xianshi>200){jsq_set_xianshi=0;}
 681   1      //////////////显示程序/////////////////////////////
 682   1      P0=table[SEG_1];//////数据从P0口送出到IC7---74HC573锁存器
 683   1      P26=0;P26=1;P26=0;///IC7数据锁存
 684   1      P0=~0x10;//////位码从P0口送出到IC6---74HC573锁存器
 685   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 686   1           delay500us();///延时500us
 687   1      /////////黑屏显示//////////////////////
 688   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 689   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 690   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 691   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 692   1      /////////2位显示//////////////////////
 693   1      P0=table[SEG_2];//////数据从P0口送出到IC7---74HC573锁存器
 694   1      P26=0;P26=1;P26=0;///IC7数据锁存
 695   1      P0=~0x20;//////位码从P0口送出到IC6---74HC573锁存器
 696   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 697   1           delay500us();///延时500us
 698   1      /////////黑屏显示//////////////////////
 699   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 700   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 701   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 702   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 703   1      /////////3位显示//////////////////////
 704   1      P0=table[SEG_3];//////数据从P0口送出到IC7---74HC573锁存器
 705   1      P26=0;P26=1;P26=0;///IC7数据锁存
 706   1      P0=~0x40;//////位码从P0口送出到IC6---74HC573锁存器
 707   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 708   1           delay500us();///延时500us
 709   1      /////////黑屏显示//////////////////////
 710   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 711   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 712   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 713   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 714   1      /////////4位显示//////////////////////
 715   1      P0=table[SEG_4];//////数据从P0口送出到IC7---74HC573锁存器
 716   1      P26=0;P26=1;P26=0;///IC7数据锁存
 717   1      P0=~0x80;//////位码从P0口送出到IC6---74HC573锁存器
 718   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 719   1           delay500us();///延时500us
 720   1      /////////黑屏显示//////////////////////
 721   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 722   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 723   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 724   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 725   1      /////////5位显示//////////////////////
 726   1      P0=table[SEG_5];//////数据从P0口送出到IC7---74HC573锁存器
 727   1      P26=0;P26=1;P26=0;///IC7数据锁存
 728   1      P0=~0x01;//////位码从P0口送出到IC6---74HC573锁存器
 729   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 730   1           delay500us();///延时500us
 731   1      /////////黑屏显示//////////////////////
 732   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 13  

 733   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 734   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 735   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 736   1      /////////6位显示//////////////////////
 737   1      P0=table[SEG_6];//////数据从P0口送出到IC7---74HC573锁存器
 738   1      P26=0;P26=1;P26=0;///IC7数据锁存
 739   1      P0=~0x02;//////位码从P0口送出到IC6---74HC573锁存器
 740   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 741   1           delay500us();///延时500us
 742   1      /////////黑屏显示//////////////////////
 743   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 744   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 745   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 746   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 747   1      /////////7位显示//////////////////////
 748   1      P0=table[SEG_7];//////数据从P0口送出到IC7---74HC573锁存器
 749   1      P26=0;P26=1;P26=0;///IC7数据锁存
 750   1      P0=~0x04;//////位码从P0口送出到IC6---74HC573锁存器
 751   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 752   1           delay500us();///延时500us
 753   1      /////////黑屏显示//////////////////////
 754   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 755   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 756   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 757   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 758   1      /////////8位显示//////////////////////
 759   1      P0=table[SEG_8];//////数据从P0口送出到IC7---74HC573锁存器
 760   1      P26=0;P26=1;P26=0;///IC7数据锁存
 761   1      P0=~0x08;//////位码从P0口送出到IC6---74HC573锁存器
 762   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 763   1           delay500us();///延时500us
 764   1      /////////黑屏显示//////////////////////
 765   1      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 766   1      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 767   1      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 768   1      P27=0;P27=1;P27=0;///IC6位码数据锁存
 769   1      }
 770          ///////////////////////////////////////////////////
 771          //函数名称:void key_init(void)
 772          //函数功能:按键初始化函数
 773          //入口参数:
 774          //出口参数:
 775          //函数说明:P3口是准双向口所以准备读取按键（按键输入）前要向P3口写“1”关闭P3口接地的场效应
 776          ///////////////////////////////////////////////////
 777          void key_init(void)      //按键初始化函数
 778            {
 779   1        P3=0xff;/////初始化P3口准备读取按键（按键输入）
 780   1        }
 781          ///////////////////////////////////////////////////
 782          //函数名称:void LED_init(void)
 783          //函数功能:LED初始化、自检函数
 784          //入口参数:
 785          //出口参数:
 786          //函数说明:采用全部显示的方法解决初始化问题
 787          ///////////////////////////////////////////////////
 788          void LED_init(void)      //LED初始化函数
 789            { 
 790   1      //////////////多次闪烁显示程序/////////////////////////////
 791   1              unsigned char i; /////局部变量定义
 792   1              for(i=3;i>0;i--)   //循环闪烁
 793   1               {
 794   2                      L1=0;L2=0;L3=0;L4=0;L5=0;L6=0;L7=0;L8=0;
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 14  

 795   2                      delay02s();///延时0.2s
 796   2                      delay02s();///延时0.2s
 797   2                      delay02s();///延时0.2s
 798   2                      delay02s();///延时0.2s
 799   2                      delay02s();///延时0.2s
 800   2                      delay02s();///延时0.2s
 801   2                      delay02s();///延时0.2s
 802   2                      delay02s();///延时0.2s
 803   2                      L1=1;L2=1;L3=1;L4=1;L5=1;L6=1;L7=1;L8=1;
 804   2                      delay02s();///延时0.2s
 805   2                      delay02s();///延时0.2s
 806   2                      delay02s();///延时0.2s
 807   2                      delay02s();///延时0.2s
 808   2                      delay02s();///延时0.2s
 809   2                      delay02s();///延时0.2s
 810   2                      delay02s();///延时0.2s
 811   2                      delay02s();///延时0.2s
 812   2               }
 813   1        }
 814          ///////////////////////////////////////////////////
 815          //函数名称:void SEG_init(void)
 816          //函数功能:数码管初始化、自检函数
 817          //入口参数:
 818          //出口参数:
 819          //函数说明:采用全部显示的方法解决初始化问题
 820          ///////////////////////////////////////////////////
 821          void SEG_init(void)      //数码管初始化函数
 822            {
 823   1      //////////////持续显示程序/////////////////////////////
 824   1              unsigned char i; /////局部变量定义
 825   1              unsigned char j; /////局部变量定义
 826   1              for(i=9;i>0;i--)   //最外层循环
 827   1                      {
 828   2      
 829   2                              SEG_1=i,SEG_2=i,SEG_3=i,SEG_4=i,SEG_5=i,SEG_6=i,SEG_7=i,SEG_8=i;
 830   2              for(j=100;j>0;j--)   //最外层循环
 831   2                      {
 832   3      
 833   3      //display_seg_HC6800();      //显示函数
 834   3      //////////////显示程序/////////////////////////////
 835   3      P0=table[SEG_1];//////数据从P0口送出到IC7---74HC573锁存器
 836   3      P26=0;P26=1;P26=0;///IC7数据锁存
 837   3      P0=~0x01;//////位码从P0口送出到IC6---74HC573锁存器
 838   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 839   3           delay500us();///延时500us
 840   3      /////////黑屏显示//////////////////////
 841   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 842   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 843   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 844   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 845   3      /////////2位显示//////////////////////
 846   3      P0=table[SEG_2];//////数据从P0口送出到IC7---74HC573锁存器
 847   3      P26=0;P26=1;P26=0;///IC7数据锁存
 848   3      P0=~0x02;//////位码从P0口送出到IC6---74HC573锁存器
 849   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 850   3           delay500us();///延时500us
 851   3      /////////黑屏显示//////////////////////
 852   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 853   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 854   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 855   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 856   3      /////////3位显示//////////////////////
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 15  

 857   3      P0=table[SEG_3];//////数据从P0口送出到IC7---74HC573锁存器
 858   3      P26=0;P26=1;P26=0;///IC7数据锁存
 859   3      P0=~0x04;//////位码从P0口送出到IC6---74HC573锁存器
 860   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 861   3           delay500us();///延时500us
 862   3      /////////黑屏显示//////////////////////
 863   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 864   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 865   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 866   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 867   3      /////////4位显示//////////////////////
 868   3      P0=table[SEG_4];//////数据从P0口送出到IC7---74HC573锁存器
 869   3      P26=0;P26=1;P26=0;///IC7数据锁存
 870   3      P0=~0x08;//////位码从P0口送出到IC6---74HC573锁存器
 871   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 872   3           delay500us();///延时500us
 873   3      /////////黑屏显示//////////////////////
 874   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 875   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 876   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 877   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 878   3      /////////5位显示//////////////////////
 879   3      P0=table[SEG_5];//////数据从P0口送出到IC7---74HC573锁存器
 880   3      P26=0;P26=1;P26=0;///IC7数据锁存
 881   3      P0=~0x10;//////位码从P0口送出到IC6---74HC573锁存器
 882   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 883   3           delay500us();///延时500us
 884   3      /////////黑屏显示//////////////////////
 885   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 886   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 887   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 888   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 889   3      /////////6位显示//////////////////////
 890   3      P0=table[SEG_6];//////数据从P0口送出到IC7---74HC573锁存器
 891   3      P26=0;P26=1;P26=0;///IC7数据锁存
 892   3      P0=~0x20;//////位码从P0口送出到IC6---74HC573锁存器
 893   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 894   3           delay500us();///延时500us
 895   3      /////////黑屏显示//////////////////////
 896   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 897   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 898   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 899   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 900   3      /////////7位显示//////////////////////
 901   3      P0=table[SEG_7];//////数据从P0口送出到IC7---74HC573锁存器
 902   3      P26=0;P26=1;P26=0;///IC7数据锁存
 903   3      P0=~0x40;//////位码从P0口送出到IC6---74HC573锁存器
 904   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 905   3           delay500us();///延时500us
 906   3      /////////黑屏显示//////////////////////
 907   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
 908   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 909   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 910   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 911   3      /////////8位显示//////////////////////
 912   3      P0=table[SEG_8];//////数据从P0口送出到IC7---74HC573锁存器
 913   3      P26=0;P26=1;P26=0;///IC7数据锁存
 914   3      P0=~0x80;//////位码从P0口送出到IC6---74HC573锁存器
 915   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 916   3           delay500us();///延时500us
 917   3      /////////黑屏显示//////////////////////
 918   3      P0=table[17];//////数据从P0口送出到IC7---74HC573锁存器
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 16  

 919   3      P26=0;P26=1;P26=0;///IC7数据锁存//////clk信号
 920   3      P0=~0x00;//////位码从P0口送出到IC6---74HC573锁存器
 921   3      P27=0;P27=1;P27=0;///IC6位码数据锁存
 922   3                      }
 923   2      }
 924   1                      SEG_1=16,SEG_2=16,SEG_3=16,SEG_4=16,SEG_5=16,SEG_6=16,SEG_7=16,SEG_8=0;//单个显示0，说明数码管准备完成
 925   1      
 926   1      }
 927          
 928          ///////////////////////////////////////////////////
 929          //函数名称:void alarm_buzzer(void)
 930          //函数功能:交流蜂鸣器自检程序
 931          //入口参数:
 932          //出口参数:
 933          //函数说明:
 934          ///////////////////////////////////////////////////
 935          void alarm_buzzer(void)         //交流蜂鸣器自检程序//
 936            {             
 937   1              //unsigned char k; /////局部变量定义
 938   1              unsigned int k; /////局部变量定义
 939   1              //for(k=248;k>0;k--) ////内层循环
 940   1              for(k=4096;k>0;k--) ////内层循环
 941   1                      {
 942   2                      FMQ=1;
 943   2                      delay500us();
 944   2                      FMQ=0;
 945   2                      delay500us();
 946   2                      }
 947   1        }  
 948          ///////////////////////////////////////////////////
 949          //函数名称:void delay50us(void)
 950          //函数功能:延时50us秒的子程序
 951          //入口参数:
 952          //出口参数:
 953          //函数说明:
 954          ///////////////////////////////////////////////////
 955          void delay50us(void)            //延时50us的子程序//
 956            {             
 957   1              unsigned int k; /////局部变量定义
 958   1              for(k=50;k>0;k--) ////内层循环
 959   1                      {
 960   2                      ;
 961   2                      }
 962   1      
 963   1        }  
 964          ///////////////////////////////////////////////////
 965          //函数名称:void int_time1(void)
 966          //函数功能:定时器t1初始化
 967          //入口参数:
 968          //出口参数:
 969          //函数说明:
 970          ///////////////////////////////////////////////////
 971          void int_time1(void) 
 972          {
 973   1      //      TMOD=0x01;                      //定义为定时器0方式1,SFR中TMOD位于不能被8整除的地址,所以要按字节方式赋值//
 974   1      //////////t1设置/////////////////////////////////////////
 975   1              TH1=(65536-500)/256;                                    //赋初值//
 976   1              TL1=(65536-500)%256;
 977   1              ET1=1;                                                                  //开启定时器1溢出中断//
 978   1              EA=1;
 979   1      //      TR1=1;                                                          //开启定时器1//
 980   1      }
C51 COMPILER V9.57.0.0   ______                                                            12/06/2021 17:59:34 PAGE 17  

 981          ///////////////////////////////////////////////////
 982          //函数名称:void interrupt_t1(void)      interrupt       3
 983          //函数功能:t1中断函数
 984          //入口参数:
 985          //出口参数:
 986          //函数说明:
 987          ///////////////////////////////////////////////////
 988          void    interrupt_t1(void)      interrupt       3               //定时器1溢出中断//
 989          {
 990   1              TH1=(65536-500)/256;                                    //赋初值//
 991   1              TL1=(65536-500)%256;
 992   1      
 993   1      FMQ=!FMQ;
 994   1      
 995   1      }
 996          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2399    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     20       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
