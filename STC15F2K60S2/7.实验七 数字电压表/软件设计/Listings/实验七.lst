C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE ______
OBJECT MODULE PLACED IN .\Objects\ʵ.obj
COMPILER INVOKED BY: E:\keil_v5\C51\BIN\C51.EXE ʵ.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\ʵ
                    -.lst) OBJECT(.\Objects\ʵ.obj)

line level    source

   1          /////////////////////////////////////////////////////////////////////////////////
   2          //Ŀ:ֵѹ_жʵ_adcʵ                                            //
   3          //  :                                                              //
   4          //ʱ:2016.6.8                                                           //
   5          //˵:һؼ ʵһģ⿪8LEDָʾʾ //
   6          //         λʾݱܣͰȡ                //
   7          //         Ӳ:1ƬP0.0~P0.7ӵ1~8LEDָʾ             //
   8          //                      24ģ⿪ӵP3.4,P3.5,P3.6,P3.7            //
   9          //                      3IC7 P2.6                      //
  10          //                      4IC6 P2.7                      //
  11          //                      5P1.1Ϊ10λADC                                 //
  12          /////////////////////////////////////////////////////////////////////////////////
  13          
  14          //#include <AT89X51.H> 
  15          #include  "STC15F2K60S2.H"
  16          
  17          ////////˵////////
  18          void delay02s(void);            //ʱ2ӳ//
  19          void delay10ms(void);           //ʱ10msӳ//
  20          void delay50us(void);           //ʱ50usӳ//
  21          void delay500us(void);          //ʱ500usӳ//
  22          void key(void);             //
  23          void display(void);         //ʾ
  24          void alarm_buzzer(void);                //Լ//
  25          //void display_seg(void);     //ʾ 
  26          void baojing(void);         // 
  27          void int_time0(void);       //t0ʱʼ
  28          void int_time1(void);       //t1ʱʼ
  29          void display_seg_v327(void);   //v3.27ʾ
  30          void display_seg_HC6800(void); //HC6800ʾ
  31          void ADC_init(void); //ADCʼ
  32          ////////ʼ////////
  33          void FMQ_init(void);      //ʼ
  34          void SEG_init(void);      //ܳʼ
  35          void LED_init(void);      //LEDʼ
  36          void key_init(void);      //ʼ
  37          ////////SFR////////
  38          //led
  39          sbit L1=P1^0;//////1ָʾƵΪL1  ֱӲP0_0;ΪAT89X51.Hڲ,
  40          sbit L2=P1^1;//////2ָʾƵΪL2 
  41          sbit L3=P1^2;//////3ָʾƵΪL3  
  42          sbit L4=P1^3;//////4ָʾƵΪL4 
  43          sbit L5=P1^4;//////5ָʾƵΪL5  
  44          sbit L6=P1^5;//////6ָʾƵΪL6 
  45          sbit L7=P1^6;//////7ָʾƵΪL7  
  46          sbit L8=P1^7;//////8ָʾƵΪL8 
  47          //
  48          sbit key_1=P3^4;//////1ΪKEY_1
  49          sbit key_2=P3^5;//////1ΪKEY_2
  50          sbit key_3=P4^2;//////1ΪKEY_3
  51          sbit key_4=P4^4;//////1ΪKEY_4
  52          //
  53          sbit duan_clc=P2^6;//////(IC7)ʱ
  54          sbit wen_clc=P2^7;//////λ(IC6)ʱ
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 2   

  55          //
  56          sbit FMQ=P3^2;//////Ƭ
  57          /////////////////////////////
  58          unsigned  char data adc_data_h _at_ 0x30;/////////STC_ADCԵַ
  59          unsigned  char data adc_data_l _at_ 0x31;/////////STC_ADCԵַ
  60          unsigned long sum_AD;/////////AD
  61          unsigned int sum_AD_JSQ;/////////AD˲
  62          float XDSD;////////ʪֵ
  63          unsigned int XDSD_xs;////////ʪֵ
  64          
  65          unsigned  int count;/////////
  66          unsigned  int AD1_count,AD2_ount,AD3_ount,AD4_ount;/////////4·ADֵ
  67          
  68          unsigned  char code table[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x
             -71,0x40,0x00};////ʾ
  69          //////////////////////////////0     1    2    3    4    5    6    7    8    9   A    B     C    D    E    F     
             -  -                    
  70          ////////////// С//////////////////
  71          unsigned  char code table_dot[]={0xbf,0x86,0xdb,0xcf,0xe6,0xed,0xfd,0x87,0xff,0xef,0x77,0x7c,0x39,0x5e,0x7
             -9,0x71,0x40,0x00};////ʾ
  72          ///////////////////////////////////0.  1.   2.   3.    4.   5.  6.   7.   8.   9.       A    B     C    D    E  
             -  F          -                                 
  73          unsigned  char shiwei;//10λ
  74          unsigned  char gewei;//λ                                 
  75          unsigned  char SEG_1,SEG_2,SEG_3,SEG_4,SEG_5,SEG_6,SEG_7,SEG_8;//////8ʾԪ
  76          bit flag_baojing;///////屨־
  77          
  78          unsigned char jsq_50ms,jsq_1s;///////50ms1S
  79          unsigned char jsq_1min,jsq_1hours;///////1ּ1Сʱ
  80          
  81          unsigned int jsq_fmq;
  82          
  83          void main(void)                         ////
  84          {
  85   1      /////////ʼ////////////////
  86   1      //FMQ_init();////////ʼԼ    
  87   1      //int_time0();/////////ʱ1ʼ////////////////
  88   1              LED_init();
  89   1      
  90   1              SEG_init();
  91   1              //alarm_buzzer();               //Լ//
  92   1              ADC_init();/////////ADCʼ//////////////// 
  93   1      while(1)                            //ѭ//Ϊѭ
  94   1              { 
  95   2      ////////////////жʵ10λADC//////////////////////////////////////
  96   2      
  97   2      ////////////////жʵʱܵĹϵ,вжϺ//////////////////////////////////////
  98   2      display_seg_v327();   //v3.27ʾ
  99   2      //display_seg_HC6800();   //HC6800ʾ
 100   2      ADC_CONTR=0X89;/////ת1000,1001B
 101   2          } 
 102   1      
 103   1      }
 104          
 105          ///////////////////////////////////////////////////
 106          //:void key(void)
 107          //:
 108          //ڲ:
 109          //ڲ:
 110          //˵:
 111          ///////////////////////////////////////////////////
 112          void key(void)      //
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 3   

 113          {
 114   1              if(key_1==0)/////////
 115   1              {
 116   2                delay10ms();///////ʱ10ms
 117   2                if(key_1==0)///////ȷ
 118   2                  {
 119   3                      count++;///////           
 120   3                      if(count>=16){count=0;}//////Ƽֵ;16Ϊ16;20Ϊ20;255Ϊcount
             -unsigend char
 121   3                      if(count>=10)
 122   3                              {
 123   4                              flag_baojing=1;//////10־;
 124   4                              }
 125   3                      else
 126   3                              {
 127   4                              flag_baojing=0;//////δ10ȡ־;
 128   4                              }
 129   3      //              P0=~count;///////ֵP0LEDָʾBCD루8421룩ʾ
 130   3                      while(key_1==0){;}///////ȴ̧
 131   3                      }
 132   2              }
 133   1              if(key_2==0)/////////
 134   1              {
 135   2                delay10ms();///////ʱ10ms
 136   2                if(key_2==0)///////ȷ
 137   2                  {
 138   3                      flag_baojing=0;//////ֶȡ־;
 139   3                      while(key_2==0){;}///////ȴ̧
 140   3                      }
 141   2              }
 142   1      }
 143          
 144          
 145          ///////////////////////////////////////////////////
 146          //:void display_seg_v327(void)      //v3.27ʾ
 147          //:ʾ
 148          //ڲ:
 149          //ڲ:
 150          //˵:
 151          ///////////////////////////////////////////////////
 152          void display_seg_v327(void)      //v3.27ʾ
 153          {
 154   1      //count=7;
 155   1      SEG_1=17;
 156   1      SEG_2=17;
 157   1      SEG_3=17;
 158   1      SEG_4=17;
 159   1      //SEG_5=7;
 160   1      //SEG_6=2;
 161   1      //SEG_7=5;
 162   1      //SEG_8=6;
 163   1      //////////////ʾݴ/////////////////////////////
 164   1      
 165   1      //SEG_5=count/1000;//õ1000λ
 166   1      //SEG_6=(count%1000)/100;//õλ100
 167   1      //SEG_7=((count%1000)%100)/10;//õ10λ
 168   1      //SEG_8=((count%1000)%100)%10;//õλ
 169   1      //////////////ʾ/////////////////////////////
 170   1      
 171   1      /////////1λʾ//////////////////////
 172   1      P0=table[SEG_1];//////ݴP0ͳIC7---74HC573
 173   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 4   

 174   1      P0=~0x01;//////λP0ͳIC6---74HC573
 175   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 176   1      //      delay10ms();///ʱ0.2s
 177   1              delay500us();///ʱ0.5ms
 178   1              ///ȥӰ//
 179   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 180   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 181   1      
 182   1      /////////2λʾ//////////////////////
 183   1      P0=table[SEG_2];//////ݴP0ͳIC7---74HC573
 184   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 185   1      P0=~0x02;//////λP0ͳIC6---74HC573
 186   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 187   1      //      delay10ms();///ʱ0.2s
 188   1              delay500us();///ʱ0.5ms
 189   1              ///ȥӰ//
 190   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 191   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 192   1      /////////3λʾ//////////////////////
 193   1      P0=table[SEG_3];//////ݴP0ͳIC7---74HC573
 194   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 195   1      P0=~0x04;//////λP0ͳIC6---74HC573
 196   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 197   1      //      delay10ms();///ʱ0.2s
 198   1              delay500us();///ʱ0.5ms
 199   1              ///ȥӰ//
 200   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 201   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 202   1      /////////4λʾ//////////////////////
 203   1      P0=table[SEG_4];//////ݴP0ͳIC7---74HC573
 204   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 205   1      P0=~0x08;//////λP0ͳIC6---74HC573
 206   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 207   1      //      delay10ms();///ʱ0.2s
 208   1              delay500us();///ʱ0.5ms
 209   1                      ///ȥӰ//
 210   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 211   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 212   1      
 213   1      /////////5λʾ//////////////////////
 214   1      P0=table[SEG_5];//////ݴP0ͳIC7---74HC573
 215   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 216   1      P0=~0x10;//////λP0ͳIC6---74HC573
 217   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 218   1      //      delay10ms();///ʱ0.2s
 219   1              delay500us();///ʱ0.5ms
 220   1              ///ȥӰ//
 221   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 222   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 223   1      
 224   1      /////////6λʾ//////////////////////
 225   1      //P0=table[SEG_6];//////ݴP0ͳIC7---74HC573
 226   1      
 227   1      P0=table_dot[SEG_6];//////ݴP0ͳIC7---74HC573---------------ʹôС
 228   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 229   1      P0=~0x20;//////λP0ͳIC6---74HC573
 230   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 231   1      //      delay10ms();///ʱ0.2s
 232   1              delay500us();///ʱ0.5ms
 233   1              ///ȥӰ//
 234   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 235   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 5   

 236   1      /////////7λʾ//////////////////////
 237   1      P0=table[SEG_7];//////ݴP0ͳIC7---74HC573
 238   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 239   1      P0=~0x40;//////λP0ͳIC6---74HC573
 240   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 241   1      //      delay10ms();///ʱ0.2s
 242   1              delay500us();///ʱ0.5ms
 243   1              ///ȥӰ//
 244   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 245   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 246   1      /////////8λʾ//////////////////////
 247   1      P0=table[SEG_8];//////ݴP0ͳIC7---74HC573
 248   1      duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 249   1      P0=~0x80;//////λP0ͳIC6---74HC573
 250   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 251   1      //      delay10ms();///ʱ0.2s
 252   1              delay500us();///ʱ0.5ms
 253   1                      ///ȥӰ//
 254   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 255   1      wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 256   1      }
 257          ///////////////////////////////////////////////////
 258          //:void display_seg_HC6800(void)
 259          //:ʾ
 260          //ڲ:
 261          //ڲ:
 262          //˵:
 263          ///////////////////////////////////////////////////
 264          void display_seg_HC6800(void)      //ʾ
 265          {
 266   1      //count=7;
 267   1      //SEG_1=4;
 268   1      //SEG_2=3;
 269   1      //SEG_3=8;
 270   1      //SEG_4=9;
 271   1      //SEG_5=7;
 272   1      //SEG_6=2;
 273   1      //SEG_7=5;
 274   1      //SEG_8=6;
 275   1      //////////////ʾݴ/////////////////////////////
 276   1      
 277   1      //SEG_5=count/1000;//õ1000λ
 278   1      //SEG_6=(count%1000)/100;//õλ100
 279   1      //SEG_7=((count%1000)%100)/10;//õ10λ
 280   1      //SEG_8=((count%1000)%100)%10;//õλ
 281   1      //////////////ʾ/////////////////////////////
 282   1      
 283   1      /////////1λʾ//////////////////////
 284   1      P0=table[SEG_1];//////ݴP0ͳIC7---74HC573
 285   1      P22=1;P23=1;P24=1;///U4λѡY1
 286   1      delay10ms();
 287   1              delay500us();///ʱ0.5ms
 288   1              ///ȥӰ//
 289   1      P0=0X00;//////ݴP0ͳIC7---74HC573
 290   1      P22=1;P23=1;P24=1;///U4λѡY1
 291   1      
 292   1      /////////2λʾ//////////////////////
 293   1      P0=table[SEG_2];//////ݴP0ͳIC7---74HC573
 294   1      P22=0;P23=1;P24=1;///U4λѡY1
 295   1      delay10ms();
 296   1              delay500us();///ʱ0.5ms
 297   1              ///ȥӰ//
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 6   

 298   1      P0=0X00;//////ݴP0ͳIC7---74HC573
 299   1      P22=0;P23=1;P24=1;///U4λѡY1
 300   1              ///ȥӰ//
 301   1      
 302   1      /////////3λʾ//////////////////////
 303   1      P0=table[SEG_3];//////ݴP0ͳIC7---74HC573
 304   1      P22=1;P23=0;P24=1;///U4λѡY1
 305   1      delay10ms();
 306   1              delay500us();///ʱ0.5ms
 307   1              ///ȥӰ//
 308   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 309   1      P22=1;P23=0;P24=1;///U4λѡY1
 310   1      
 311   1      /////////4λʾ//////////////////////
 312   1      P0=table[SEG_4];//////ݴP0ͳIC7---74HC573
 313   1      P22=0;P23=0;P24=1;///U4λѡY1
 314   1      delay10ms();
 315   1              delay500us();///ʱ0.5ms
 316   1              ///ȥӰ//
 317   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 318   1      P22=0;P23=0;P24=1;///U4λѡY1
 319   1      
 320   1      /////////5λʾ//////////////////////
 321   1      P0=table[SEG_5];//////ݴP0ͳIC7---74HC573
 322   1      P22=1;P23=1;P24=0;///U4λѡY1
 323   1      delay10ms();
 324   1              delay500us();///ʱ0.5ms
 325   1              ///ȥӰ//
 326   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 327   1      P22=1;P23=1;P24=0;///U4λѡY1
 328   1      
 329   1      /////////6λʾ//////////////////////
 330   1      P0=table_dot[SEG_6];//////ݴP0ͳIC7---74HC573
 331   1      P22=0;P23=1;P24=0;///U4λѡY1
 332   1      delay10ms();
 333   1              delay500us();///ʱ0.5ms
 334   1              ///ȥӰ//
 335   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 336   1      P22=0;P23=1;P24=0;///U4λѡY1
 337   1      
 338   1      /////////7λʾ//////////////////////
 339   1      P0=table[SEG_7];//////ݴP0ͳIC7---74HC573
 340   1      P22=1;P23=0;P24=0;///U4λѡY1
 341   1      delay10ms();
 342   1              delay500us();///ʱ0.5ms
 343   1              ///ȥӰ//
 344   1      P0=0XFF;//////ݴP0ͳIC7---74HC573
 345   1      P22=1;P23=0;P24=0;///U4λѡY1
 346   1      
 347   1      /////////8λʾ//////////////////////
 348   1      P0=table[SEG_8];//////ݴP0ͳIC7---74HC573
 349   1      P22=0;P23=0;P24=0;///U4λѡY1
 350   1      delay10ms();
 351   1              delay500us();///ʱ0.5ms
 352   1              ///ȥӰ//
 353   1      P0=0X00;//////ݴP0ͳIC7---74HC573
 354   1      P22=0;P23=0;P24=0;///U4λѡY1
 355   1      /*
 356   1      /////////1λʾ//////////////////////
 357   1      
 358   1      P0=table[SEG_8];//////ݴP0ͳIC7---74HC573
 359   1      P10=0;P10=1;P10=0;///IC7
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 7   

 360   1      P22=0;P23=0;P24=0;///1381λ
 361   1           delay500us();///ʱ500us
 362   1      
 363   1      /////////2λʾ//////////////////////
 364   1      P0=table[SEG_7];//////ݴP0ͳIC7---74HC573
 365   1      P10=0;P10=1;P10=0;///IC7
 366   1      P22=1;P23=0;P24=0;///1382λ
 367   1           delay500us();///ʱ500us
 368   1      /////////3λʾ//////////////////////
 369   1      P0=table[SEG_6];//////ݴP0ͳIC7---74HC573
 370   1      P10=0;P10=1;P10=0;///IC7
 371   1      P22=0;P23=1;P24=0;///1383λ
 372   1           delay500us();///ʱ500us
 373   1      
 374   1      /////////4λʾ//////////////////////
 375   1      P0=table[SEG_5];//////ݴP0ͳIC7---74HC573
 376   1      P10=0;P10=1;P10=0;///IC7
 377   1      P22=1;P23=1;P24=0;///1384λ
 378   1           delay500us();///ʱ500us
 379   1      
 380   1      /////////5λʾ//////////////////////
 381   1      P0=table[SEG_4];//////ݴP0ͳIC7---74HC573
 382   1      P10=0;P10=1;P10=0;///IC7
 383   1      P22=0;P23=0;P24=1;///1385λ
 384   1           delay500us();///ʱ500us
 385   1      /////////6λʾ//////////////////////
 386   1      P0=table[SEG_3];//////ݴP0ͳIC7---74HC573
 387   1      P10=0;P10=1;P10=0;///IC7
 388   1      P22=1;P23=0;P24=1;///1386λ
 389   1           delay500us();///ʱ500us
 390   1      
 391   1      /////////7λʾ//////////////////////
 392   1      P0=table[SEG_2];//////ݴP0ͳIC7---74HC573
 393   1      P10=0;P10=1;P10=0;///IC7
 394   1      P22=0;P23=1;P24=1;///1387λ
 395   1           delay500us();///ʱ500us
 396   1      
 397   1      /////////8λʾ//////////////////////
 398   1      P0=table[SEG_1];//////ݴP0ͳIC7---74HC573
 399   1      P10=0;P10=1;P10=0;///IC7
 400   1      P22=1;P23=1;P24=1;///1388λ
 401   1           delay500us();///ʱ500us
 402   1      */
 403   1      }
 404          
 405          ///////////////////////////////////////////////////
 406          //:void delay500us(void)
 407          //:ʱ500usӳ
 408          //ڲ:
 409          //ڲ:
 410          //˵:
 411          ///////////////////////////////////////////////////
 412          void delay500us(void)           //ʱ10msӳ//
 413          {               
 414   1                      unsigned char k; /////ֲ
 415   1                                              {
 416   2                                                      for(k=248;k>0;k--) ////ڲѭ
 417   2                                                              {
 418   3                                                              ;
 419   3                                                              }
 420   2                                              }
 421   1      }  
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 8   

 422          ///////////////////////////////////////////////////
 423          //:void delay10ms(void)
 424          //:ʱ10msӳ
 425          //ڲ:
 426          //ڲ:
 427          //˵:
 428          ///////////////////////////////////////////////////
 429          void delay10ms(void)            //ʱ10msӳ//
 430          {               
 431   1      //              unsigned char i,j,k; /////ֲ
 432   1                      unsigned char j,k; /////ֲ
 433   1      //              for(i=20;i>0;i--)   //ѭ
 434   1      //                      {
 435   1                              for(j=20;j>0;j--)   // ϲѭ
 436   1                                              {
 437   2                                                      for(k=248;k>0;k--) ////ڲѭ
 438   2                                                              {
 439   3                                                              ;
 440   3                                                              }
 441   2                                              }
 442   1      //                      }
 443   1      } 
 444           
 445          ///////////////////////////////////////////////////
 446          //:void delay02s(void)
 447          //:ʱ0.2ӳ
 448          //ڲ:
 449          //ڲ:
 450          //˵:
 451          ///////////////////////////////////////////////////
 452          void delay02s(void)             //ʱӳ//
 453          {               
 454   1                      unsigned char i,j,k; /////ֲ
 455   1                      for(i=20;i>0;i--)   //ѭ
 456   1                              {
 457   2                              for(j=20;j>0;j--)   // ϲѭ
 458   2                                              {
 459   3                                                      for(k=248;k>0;k--) ////ڲѭ
 460   3                                                              {
 461   4                                                              ;
 462   4                                                              }
 463   3                                              }
 464   2                              }
 465   1      } 
 466          ///////////////////////////////////////////////////
 467          //:void int_time0(void)
 468          //:ʱt0ʼ
 469          //ڲ:
 470          //ڲ:
 471          //˵:
 472          ///////////////////////////////////////////////////
 473          void int_time0(void) 
 474          {
 475   1              //öʱ0ʽ//
 476   1              TMOD=0x01;                                                              //Ϊʱ0ʽ1,SFRTMODλڲܱ8ĵַ,Ҫֽڷʽֵ//
 477   1              //ֵ1//
 478   1              TH0=(65536-100)/256;                                    //ֵ//
 479   1              TL0=(65536-100)%256;
 480   1              //жͨ//
 481   1              ET0=1;                                                                  //ʱ0ж//
 482   1              EA=1;                                                                   //ܵжϿ//
 483   1      
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 9   

 484   1      
 485   1      ////////////
 486   1              TR0=1;                                                                  //ʱ0//
 487   1      
 488   1      }
 489          
 490          ///////////////////////////////////////////////////
 491          //:void interrupt_t0(void)      interrupt       1
 492          //:t0жϺ
 493          //ڲ:
 494          //ڲ:
 495          //˵:
 496          ///////////////////////////////////////////////////
 497          void    interrupt_t0(void)      interrupt       1               //ʱ0ж//
 498          {
 499   1      ////////////ֵ//////////////////////////////////
 500   1              //ֵ1//
 501   1              TH0=(65536-100)/256;                                    //ֵ//
 502   1              TL0=(65536-100)%256;
 503   1      
 504   1                              if(SEG_6>=2)
 505   1                              {
 506   2                              FMQ=!FMQ;
 507   2                              }
 508   1      
 509   1      
 510   1      }
 511          
 512          
 513          ///////////////////////////////////////////////////
 514          //:void ADC_init(void)
 515          //:ADCʼ
 516          //ڲ:
 517          //ڲ:
 518          //˵:
 519          ///////////////////////////////////////////////////
 520          void    ADC_init(void)  
 521          {
 522   1              unsigned int i; /////ֲ
 523   1      /////////////////ģ///////////////////////////
 524   1      P1ASF=0X02;/////P1.1ΪADC0000,0010B
 525   1      //P1ASF=P1ASF|0X02;/////P1.1ΪADC
 526   1      //P1ASF=0X0f;/////P1.0~P1.3ΪADC
 527   1      /////////////////ADC///////////////////////////
 528   1      ADC_CONTR=0X81;//1000,0001BADתԴͨΪP1.1תٶΪһ90ʱڡת־
 529   1      for(i=0;i<10000;i++);///1msʵʱʱȴADCͨȶ20~200us
 530   1      /////////////////ADCתʽ///////////////////////////
 531   1      CLK_DIV |=0X20;////ADRJ=1;ADתʽΪҶ0000,0010B
 532   1      /////////////////жͨ///////////////////////////
 533   1      EADC=1;////
 534   1      EA=1;////
 535   1      /////////////////ADCת///////////////////////////
 536   1      ADC_CONTR=0X89;///ת1000,1100B
 537   1      
 538   1      
 539   1      
 540   1      }
 541          
 542          ///////////////////////////////////////////////////
 543          //:void interrupt_ADC(void)     interrupt       5
 544          //:t0жϺ
 545          //ڲ:
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 10  

 546          //ڲ:
 547          //˵:
 548          ///////////////////////////////////////////////////
 549          void    interrupt_ADC(void)     interrupt       5               
 550          {
 551   1      /////////////////ADC-----ҪĿ־///////////////////////////
 552   1      ADC_CONTR=0X81;//ADC_FLAG1000,0001B
 553   1      
 554   1      /////////////////ADC-----ݸߵλ///////////////////////////
 555   1      adc_data_h=ADC_RES&0X03;///ADCλֵ
 556   1      adc_data_l=ADC_RESL;///ADCλֵ
 557   1      /////////////////ADC-----ADCֵ///////////////////////////
 558   1      AD1_count=adc_data_h*256+adc_data_l;
 559   1      
 560   1      ////////////////ݴ/////////////////////////////
 561   1      
 562   1      ////////////////ƽ˲/////////////////////////////
 563   1      sum_AD_JSQ++;
 564   1      
 565   1      if(sum_AD_JSQ<=1024){sum_AD=AD1_count+sum_AD;}
 566   1      
 567   1      //else
 568   1      if(sum_AD_JSQ>1024)
 569   1      {
 570   2      //sum_AD=1234;
 571   2      sum_AD=sum_AD/1024;
 572   2      
 573   2      sum_AD_JSQ=0;//sum_AD=0;XDSD=0;
 574   2      
 575   2      
 576   2      ////////////////ADCתΪ0~5vѹ/////////////////////////////
 577   2      sum_AD=(1000*sum_AD)/1024;
 578   2      if(sum_AD>350)
 579   2      {
 580   3              //alarm_buzzer();
 581   3      }
 582   2      ////////////////ADCʾ/////////////////////////////
 583   2      
 584   2      ////////////////ʾ׼////////////////////////////////////////////////////
 585   2      //sum_AD=1234;
 586   2      //count=sum_AD;
 587   2      
 588   2      SEG_5=sum_AD/1000;//õ1000λ
 589   2      if(SEG_5==0){
 590   3      SEG_5=17;
 591   3      }
 592   2      SEG_6=(sum_AD%1000)/100;//õλ100
 593   2      SEG_7=((sum_AD%1000)%100)/10;//õ10λ
 594   2      SEG_8=((sum_AD%1000)%100)%10;//õλ
 595   2      }
 596   1      ///////////////µתʼ////////////////////////////////////////////////////
 597   1      ADC_CONTR=0X8C;/////ת
 598   1      
 599   1      }
 600          ///////////////////////////////////////////////////
 601          //:void key_init(void)
 602          //:ʼ
 603          //ڲ:
 604          //ڲ:
 605          //˵:P3׼˫׼ȡ룩ǰҪP3д1رP3ڽӵصĳЧӦ
 606          ///////////////////////////////////////////////////
 607          void key_init(void)      //ʼ
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 11  

 608          {
 609   1      P3=0xff;/////ʼP3׼ȡ룩
 610   1      }
 611          ///////////////////////////////////////////////////
 612          //:void LED_init(void)
 613          //:LEDʼԼ캯
 614          //ڲ:
 615          //ڲ:
 616          //˵:ȫʾķʼ
 617          ///////////////////////////////////////////////////
 618          void LED_init(void)      //LEDʼ
 619          {
 620   1      //////////////˸ʾ/////////////////////////////
 621   1                      unsigned char i; /////ֲ
 622   1                      for(i=3;i>0;i--)   //ѭ˸
 623   1                              {
 624   2                                      L1=0;L2=0;L3=0;L4=0;L5=0;L6=0;L7=0;L8=0;
 625   2                                      delay02s();///ʱ0.2s
 626   2                                      delay02s();///ʱ0.2s
 627   2                                      delay02s();///ʱ0.2s
 628   2                                      L1=1;L2=1;L3=1;L4=1;L5=1;L6=1;L7=1;L8=1;
 629   2                                      delay02s();///ʱ0.2s
 630   2                                      delay02s();///ʱ0.2s
 631   2                                      delay02s();///ʱ0.2s
 632   2                              }
 633   1      }
 634          ///////////////////////////////////////////////////
 635          //:void SEG_init(void)
 636          //:ܳʼԼ캯
 637          //ڲ:
 638          //ڲ:
 639          //˵:ȫʾķʼ
 640          ///////////////////////////////////////////////////
 641          void SEG_init(void)      //ܳʼ
 642          {
 643   1      //////////////ʾ/////////////////////////////
 644   1                      unsigned char i; /////ֲ
 645   1                      for(i=9;i>0;i--)   //ѭ
 646   1                              {
 647   2                              //SEG_1=i,SEG_2=i,SEG_3=i,SEG_4=i,SEG_5=i,SEG_6=i,SEG_7=i,SEG_8=i;
 648   2                              SEG_1=i;                        
 649   2                              P0=table[SEG_1];//////ݴP0ͳIC7---74HC573
 650   2                              duan_clc=0;duan_clc=1;duan_clc=0;///IC7
 651   2                              P0=~0xFF;//////λP0ͳIC6---74HC573--------ȫ
 652   2                              wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 653   2                              //      delay10ms();///ʱ0.2s
 654   2                                      delay02s();///ʱ0.2s
 655   2                                      delay02s();///ʱ0.2s
 656   2                                      delay02s();///ʱ0.2s
 657   2                                      delay02s();///ʱ0.2s
 658   2                                      delay02s();///ʱ0.2s
 659   2      
 660   2                                      ///ȥӰ//
 661   2                              P0=0XFF;//////ݴP0ͳIC7---74HC573
 662   2                              wen_clc=0;wen_clc=1;wen_clc=0;///IC6λ
 663   2                              ///display_seg();
 664   2      
 665   2                              }
 666   1                              //SEG_1=0,SEG_2=16,SEG_3=16,SEG_4=16,SEG_5=16,SEG_6=16,SEG_7=16,SEG_8=16;//ʾ0˵׼
             -
 667   1                              SEG_1=0;
 668   1      }
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 12  

 669          
 670          ///////////////////////////////////////////////////
 671          //:void alarm_buzzer(void)
 672          //:Լ
 673          //ڲ:
 674          //ڲ:
 675          //˵:
 676          ///////////////////////////////////////////////////
 677          void alarm_buzzer(void)         //Լ//
 678            {             
 679   1              unsigned char k; /////ֲ
 680   1              for(k=248;k>0;k--) ////ڲѭ
 681   1                      {
 682   2                      FMQ=1;
 683   2                      delay50us();
 684   2                      FMQ=0;
 685   2                      delay50us();
 686   2                      }
 687   1                      FMQ=1;
 688   1        }  
 689          ///////////////////////////////////////////////////
 690          //:void delay50us(void)
 691          //:ʱ50usӳ
 692          //ڲ:
 693          //ڲ:
 694          //˵:
 695          ///////////////////////////////////////////////////
 696          void delay50us(void)            //ʱ50usӳ//
 697            {             
 698   1      ///////ʱѡʹڲʱʾʵʱܾͲ//////////////////
 699   1              unsigned int k; /////ֲ
 700   1              for(k=1;k>0;k--) ////ڲѭ
 701   1                      {
 702   2                      display_seg_v327();
 703   2                      //display_seg_HC6800();   //HC6800ʾ
 704   2      
 705   2                      }
 706   1      ////////////ʱѡʹڲʱʹʱ//////////////////
 707   1      //      unsigned int k; /////ֲ
 708   1      //      for(k=50;k>0;k--) ////ڲѭ
 709   1      //              {
 710   1      //              ;
 711   1      //              }
 712   1      /////////////////////////////////
 713   1      ////////////ʱѡʹڲʱʹʱ˸//////////////////
 714   1      //      unsigned int k; /////ֲ
 715   1      //      for(k=500;k>0;k--) ////ڲѭ
 716   1      //              {
 717   1      //              ;
 718   1      //              }
 719   1      /////////////////////////////////
 720   1        }  
 721          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1191    ----
   CONSTANT SIZE    =     36    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     38       3
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.57.0.0   ______                                                            12/15/2021 20:52:22 PAGE 13  

   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
